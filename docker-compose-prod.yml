version: "3"
services: 

    traefik:
        image: traefik:v2.3
    
        ports:
            - "80:80"
            - "443:443"
        volumes:
            - /var/run/docker.sock:/var/run/docker.sock

        environment:
            - TRAEFIK_PROVIDERS_DOCKER=true


            - TRAEFIK_ENTRYPOINTS_web=true
            - TRAEFIK_ENTRYPOINTS_web_ADDRESS=:80

            - TRAEFIK_ENTRYPOINTS_websecure=true
            - TRAEFIK_ENTRYPOINTS_websecure_ADDRESS=:443

    web:
        build:
            context: ./eticketing
            dockerfile: Dockerfile

        labels:
            - "traefik.http.routers.api.rule=Host(`sad2a.cs.ait.ac.th,`www.sad2a.cs.ait.ac.th`,`sad2b.cs.ait.ac.th,`www.sad2b.cs.ait.ac.th`)"
            - "traefik.http.routers.api.entrypoints=web"
            - "traefik.http.services.api.loadbalancer.server.port=8000"        

volumes: 
  eticketing-traefik-proxy: